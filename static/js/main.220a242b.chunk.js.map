{"version":3,"sources":["theme/MaterialUI.tsx","layouts/SideMenu.tsx","contexts/Contexts.ts","components/parameter_settings/ParameterSettingsTab.tsx","utils/three/OrbitControls.js","utils/three/VRButton.js","utils/three/ObjectFactory.tsx","components/scene/ThreeBaseScene.tsx","components/scene/CoordinateAxisScene.tsx","components/scene/TestBoxPlaneScene.tsx","types/Chart.ts","components/chart/chartjs/Scatter.tsx","components/chart/ConfigurableChart.tsx","scene_settings/samples/free_falling/FreeFallingParameters.ts","scene_settings/samples/free_falling/FreeFallingObjects.ts","simulator/systems/BouncingBallSystem.ts","simulator/systems/BaseSystem.ts","components/scene/BouncingBallScene.tsx","pages/PhysicalSimulation.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["darkTheme","createTheme","palette","primary","light","main","dark","contrastText","secondary","type","drawerWidth","useStyles","makeStyles","theme","createStyles","root","display","appBar","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","width","marginLeft","easeOut","enteringScreen","menuButton","marginRight","spacing","hide","drawer","flexShrink","drawerPaper","drawerHeader","alignItems","padding","mixins","toolbar","justifyContent","content","flexGrow","contentShift","PersistentDrawerLeft","classes","useTheme","React","useState","open","setOpen","className","CssBaseline","AppBar","position","clsx","Toolbar","IconButton","color","onClick","edge","Typography","variant","noWrap","Drawer","anchor","paper","direction","Divider","List","to","style","ListItem","button","ListItemIcon","ListItemText","ThreeContext","createContext","ParameterContext","ChartContext","TabPanel","props","children","value","index","other","role","hidden","id","Box","p","a11yProps","backgroundColor","background","createParameterWidgets","params","category","contextValue","autoApply","categoryParams","filter","v","paramChanged","e","console","log","target","name","i","length","undefined","onParameterChaneged","map","Paper","marginBottom","paddingTop","paddingLeft","paddingRight","parameterType","TextField","label","placeholder","defaultValue","margin","InputLabelProps","shrink","onChange","maxValue","minValue","Slider","min","max","step","valueLabelDisplay","ParameterSettingsTab","useContext","setAutoApply","setValue","paramsCp","clone","updatedParams","uniqueCategories","Array","from","Set","values","Tabs","event","newValue","scrollButtons","minHeight","idx","Tab","minWidth","overflowY","height","window","innerHeight","Button","Checkbox","checked","marginTop","OrbitControls","object","domElement","warn","document","error","this","enabled","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TOUCH","TWO","DOLLY_PAN","target0","position0","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","listenToKeyEvents","addEventListener","onKeyDown","saveState","scope","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","offset","quat","Quaternion","setFromUnitVectors","up","quatInverse","invert","lastPosition","lastQuaternion","twoPI","sub","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","isFinite","makeSafe","radius","scale","addScaledVector","panOffset","add","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onPointerDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","ownerDocument","onPointerMove","onPointerUp","startEvent","endEvent","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","clientX","clientY","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","x","y","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchMoveRotate","subVectors","handleTouchMovePan","handleTouchMoveDolly","pointerType","mouseAction","preventDefault","focus","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","onMouseDown","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","onMouseMove","onMouseUp","stopPropagation","handleMouseWheel","needsUpdate","keyCode","handleKeyDown","handleTouchStartDollyPan","DOLLY_ROTATE","handleTouchStartDollyRotate","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","prototype","Object","EventDispatcher","constructor","MapControls","call","VRButton","renderer","options","createElement","showWebXRNotFound","cursor","onmouseenter","onmouseleave","onclick","textContent","stylizeElement","border","borderRadius","font","textAlign","opacity","outline","zIndex","navigator","xr","isSessionSupported","then","supported","currentSession","onSessionStarted","session","onSessionEnded","setSession","requestSession","optionalFeatures","end","showEnterVR","message","isSecureContext","href","location","replace","innerHTML","textDecoration","ObjectFactory","pos_x","pos_y","pos_z","side","THREE","texture_filepath","sphereRadius","sphereGeometry","matArgs","transparent","depthWrite","load","sphereMaterial","sphere","z","castShadow","size_x","size_y","size_z","box","receiveShadow","rotation_x","rotation_y","rotation_z","size_h","size_w","planeGeometry","planeMaterial","plane","rotation","dir_x","dir_y","dir_z","headWidth","headLength","dir","pos","arrowHelper","material","sprite","tube","tubularSegments","radiusSegments","q","roughness","geometry","torus","addObject","obj","objects","tag","push","findThreeObj","ThreeBaseScene","_lookAt","container","setContainer","scene","antialias","bgColor","clock","cnt","setCnt","setOrbitControls","camera","setSize","setClearColor","shadowMap","useEffect","appendChild","_orbitControls","setAnimationLoop","dt","getDelta","onUpdate","onUpdateChart","render","ReactDOM","body","createButton","remove","apply","ambientLight","spotLight","onReset","ref","CoordinateAxisScene","OF","createArrow","objType","TestBoxPlaneScene","createTorusKnot","createPlane","ChartTypeList","Scatter2D","styled","div","chartContextValue","data","labels","datasets","fill","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","responsive","legend","animation","redraw","chartRefs","setChartRefs","refs","chart","chartType","variableX","variableY","variableZ","data_","convertChartDataFormat","headerWidgets","variables","numVariables","setChartType","setVariableX","setVariableY","setVariableZ","Grid","item","xs","InputLabel","htmlFor","Select","fontSize","MenuItem","s","xyzSelect","variable","setVariable","x_variable","y_variable","z_variable","d","ConfigurableChart","nv","numSelectableVariables","onSceneUpdateChartCallbacks","simulator","historicalData","FreeFallingParameters","FreeFallingObjects","BouncingBallSystem","_ballObjIdx","_groundObjIdx","_gaCoefIdx","_ballRadiusIdx","_groundHeightIdx","_restitutionCoeffIdx","_airRessistanceCoefIdx","_initialHeightIdx","_massIdx","_ballPosys","_ballVelys","_energies","findObjIndex","findParamIndex","_is_running","mass","_systemParams","_objStates","vel","gravitationalForce","ballRadius","groundHeight","restitutionCoeff","MAX_QUEUE","shift","energy","t","Error","gaCoef","parseFloat","splice","initialObjStates","systemParams","_t","_initialObjStates","MAX_DT","_ts","_update","BouncingBallScene","system","ballThreeObj","setBallThreeObj","groundThreeObj","setGroundThreeObj","ballHeight","getBallHeight","getBallRadius","getGroundHeight","setSimulator","threeObjs","objs","forEach","createSphere","textureFilepath","createThreeObjectsFromConfig","stop","PhysicalSimulation","scenes","selectedScene","setSelectedScene","setThreeObjs","cam","innerWidth","setCamera","runStopBtnText","setRunStopBtnText","selectableVariables","setSelectableVariables","setOnSceneUpdateChartCallbacks","varibles","sceneName","Container","maxWidth","md","lg","ListSubheader","isRunning","start","Provider","setSystemParams","App","basename","process","path","component","exact","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.220a242b.chunk.js","sourcesContent":["import { createTheme } from '@material-ui/core/styles'\n\n\nexport const darkTheme = createTheme({\n  palette: {\n    primary: {\n      light: '#757ce8',\n      main: '#d32f2f',\n      // main: '#a82414',\n      dark: '#002884',\n      contrastText: '#fff',\n    },\n    secondary: {\n      light: '#ff7961',\n      main: '#651fff',\n      dark: '#ba000d',\n      contrastText: '#000',\n    },\n    type: \"dark\",\n  },\n});\n","import React from 'react';\nimport clsx from 'clsx';\nimport { makeStyles, useTheme, Theme, createStyles } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport List from '@material-ui/core/List';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListAltIcon from '@material-ui/icons/ListAlt';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { Link } from \"react-router-dom\";\n\n\nconst drawerWidth = 240;\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n    },\n    appBar: {\n      transition: theme.transitions.create(['margin', 'width'], {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n    },\n    appBarShift: {\n      width: `calc(100% - ${drawerWidth}px)`,\n      marginLeft: drawerWidth,\n      transition: theme.transitions.create(['margin', 'width'], {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n    },\n    menuButton: {\n      marginRight: theme.spacing(2),\n    },\n    hide: {\n      display: 'none',\n    },\n    drawer: {\n      width: drawerWidth,\n      flexShrink: 0,\n    },\n    drawerPaper: {\n      width: drawerWidth,\n    },\n    drawerHeader: {\n      display: 'flex',\n      alignItems: 'center',\n      padding: theme.spacing(0, 1),\n      // necessary for content to be below app bar\n      ...theme.mixins.toolbar,\n      justifyContent: 'flex-end',\n    },\n    content: {\n      flexGrow: 1,\n      padding: theme.spacing(2),\n      transition: theme.transitions.create('margin', {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n      marginLeft: -drawerWidth,\n    },\n    contentShift: {\n      transition: theme.transitions.create('margin', {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n      marginLeft: 0,\n    },\n  }),\n);\n\nexport default function PersistentDrawerLeft() {\n  const classes = useStyles();\n  const theme = useTheme();\n  const [open, setOpen] = React.useState(false);\n\n  const handleDrawerOpen = () => {\n    setOpen(true);\n  };\n\n  const handleDrawerClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar\n        position=\"fixed\"\n        className={clsx(classes.appBar, {\n          [classes.appBarShift]: open,\n        })}\n      >\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={clsx(classes.menuButton, open && classes.hide)}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" noWrap>\n            Menu\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <Drawer\n        className={classes.drawer}\n        variant=\"persistent\"\n        anchor=\"left\"\n        open={open}\n        classes={{\n          paper: classes.drawerPaper,\n        }}\n      >\n        <div className={classes.drawerHeader}>\n          <IconButton onClick={handleDrawerClose}>\n            {theme.direction === 'ltr' ? <ChevronLeftIcon /> : <ChevronRightIcon />}\n          </IconButton>\n        </div>\n        <Divider />\n        <List>\n          <Link to=\"/physical_simulation\" style={{ color: '#FFF' }}>\n            <ListItem button key=\"main_key\">\n              <ListItemIcon><ListAltIcon/></ListItemIcon>\n              <ListItemText primary=\"Physical Simulation\" />\n            </ListItem>\n          </Link>\n        </List>\n        <Divider />\n      </Drawer>\n      <main\n        className={clsx(classes.content, {\n          [classes.contentShift]: open,\n        })}\n      >\n        <div className={classes.drawerHeader} />\n      </main>\n    </div>\n  );\n}\n","import React from 'react';\nimport * as THREE from 'three';\nimport { Vec3, ThreeObjects } from '../types/Three';\nimport { Parameter } from '../types/Parameter';\nimport { BaseSystem } from '../simulator/systems/BaseSystem';\nimport { ChartJSType } from '../types/Chart';\n\n\nexport type ThreeContextValue = {\n  width: number,\n  height: number,\n  camera: THREE.PerspectiveCamera,\n  setCamera?: React.Dispatch<React.SetStateAction<THREE.PerspectiveCamera>>,\n  onObjectsChanged?: (objs: ThreeObjects) => void,\n  lookAt?: Vec3,\n  bgColor?: THREE.Color,\n  onUpdate?: (dt: number) => void,\n  onUpdateChart?: (dt: number) => void,\n  objects?: ThreeObjects,\n  sceneResetFlag?: boolean,\n  simulator?: BaseSystem,\n  setSimulator?: React.Dispatch<React.SetStateAction<BaseSystem | undefined>>,\n};\nexport const ThreeContext = React.createContext<ThreeContextValue>({} as ThreeContextValue);\n\n\nexport type ParameterContextValue = {\n  params: Parameter[],\n  onParameterChaneged?: (params: Parameter[], autoApply: boolean) => void\n}\nexport const ParameterContext = React.createContext<ParameterContextValue>({} as ParameterContextValue);\n\n\nexport type ChartContextValue = {\n  onSceneUpdateChartCallbacks?: {[tag: string]: (dt: number, simulator?: BaseSystem) => void},\n  setOnSceneUpdateChartCallbacks?:  React.Dispatch<React.SetStateAction<{[tag: string]: (dt: number, simulator?: BaseSystem) => void}>>,\n  chartRefs?: {[tag: string]: React.Ref<ChartJSType>},\n  setChartRefs?: React.Dispatch<React.SetStateAction<{[tag: string]: React.Ref<ChartJSType>}>>\n}\nexport const ChartContext = React.createContext<ChartContextValue>({} as ChartContextValue);\n","import React, { useState } from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Button from '@mui/material/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Slider from '@mui/material/Slider';\nimport Checkbox from '@mui/material/Checkbox';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport clone from 'clone';\n\nimport { Parameter } from '../../types/Parameter';\nimport { ParameterContext, ParameterContextValue } from '../../contexts/Contexts';\n\n\ninterface TabPanelProps {\n  children?: React.ReactNode;\n  index: any;\n  value: any;\n}\n\nfunction TabPanel(props: TabPanelProps) {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && (\n        <Box p={0}>\n          <Typography>{children}</Typography>\n        </Box>\n      )}\n    </div>\n  );\n}\n\nfunction a11yProps(index: any) {\n  return {\n    id: `simple-tab-${index}`,\n    'aria-controls': `simple-tabpanel-${index}`,\n  };\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n  },\n}));\n\nconst createParameterWidgets = (\n  params: Parameter[],\n  category: string,\n  contextValue: ParameterContextValue,\n  autoApply: boolean,\n) => {\n  const categoryParams = params.filter(v => v.category === category);\n\n  const paramChanged = (e: any) => {\n    console.log(`new value : ${category} : ${e.target.name} : ${e.target.value}`);\n    for (let i = 0; i < params.length; ++i) {\n      if (params[i].category === category && params[i].id === e.target.name) {\n        params[i].value = e.target.value;\n        // setUpdatedParams(updatedParams);\n        if (contextValue.onParameterChaneged !== undefined) {\n          contextValue.onParameterChaneged(params, autoApply);\n        }\n        break;\n      }\n    }\n  }\n\n  return categoryParams.map(v => {\n    return (\n      <Paper style={{marginBottom: \"10px\", paddingTop: \"20px\", paddingLeft: \"20px\", paddingRight: \"25px\"}}>\n        <Typography>{v.name}</Typography>\n        {\n          (() => {\n            if (v.parameterType === \"NUMBER_IMPUT\") {\n              return (\n                <TextField\n                  id={v.id}\n                  label={v.id}\n                  name={v.id}\n                  // style={{ marginLeft: 8, marginRight: 8 }}\n                  placeholder={ v.value as string }\n                  defaultValue={ v.value as string }\n                  // fullWidth\n                  margin=\"normal\"\n                  InputLabelProps={{\n                    shrink: true,\n                  }}\n                  variant=\"outlined\"\n                  onChange={paramChanged}\n                />\n              )\n            } else if (v.parameterType === \"SLIDER_FLOAT\") {\n              const maxValue = v.maxValue ? v.maxValue : 0;\n              const minValue = v.minValue ? v.minValue : 0;\n              return (\n                <Slider\n                  name={v.id}\n                  defaultValue={v.value as number}\n                  min={minValue}\n                  max={maxValue}\n                  step={0.002*(maxValue-minValue)}\n                  aria-label=\"Default\"\n                  valueLabelDisplay=\"auto\"\n                  onChange={paramChanged}\n                  // style={{ marginLeft: \"20px\", paddingRight: \"30px\" }}\n                />\n              )\n            } else if (v.parameterType === \"SLIDER_INT\") {\n              return (\n                <Slider\n                  name={v.id}\n                  defaultValue={v.value as number}\n                  min={v.minValue}\n                  max={v.maxValue}\n                  aria-label=\"Default\"\n                  valueLabelDisplay=\"auto\"\n                  onChange={paramChanged}\n                  // style={{ marginLeft: \"20px\", paddingRight: \"30px\" }}\n                />\n              )\n            }\n          })()\n        }\n      </Paper>\n    )\n  })\n}\n\ntype Props = {\n}\n\nconst ParameterSettingsTab: React.FC<Props> = (props: Props) => {\n\n  const contextValue = React.useContext(ParameterContext);\n  const [autoApply, setAutoApply] = useState<boolean>(true);\n\n  const classes = useStyles();\n  const [value, setValue] = React.useState(0);\n\n  const handleTagChange = (event: React.ChangeEvent<{}>, newValue: number) => {\n    setValue(newValue);\n  };\n\n  const paramsCp = clone(contextValue.params);\n  const [updatedParams, setUpdatedParams] = useState<Parameter[]>(paramsCp);\n  console.log(paramsCp)\n  console.log(updatedParams)\n\n  const uniqueCategories = Array.from((new Set(\n    contextValue.params.map(v => v.category)\n  ).values()))\n\n  console.log(uniqueCategories);\n\n  return (\n    <div>\n      {/* <Typography variant=\"h6\" align=\"left\" gutterBottom> */}\n        Parameter Settings\n      {/* </Typography> */}\n      <AppBar position=\"static\">\n        <Tabs\n          value={value}\n          onChange={handleTagChange}\n          variant=\"scrollable\"\n          scrollButtons=\"auto\"\n          aria-label=\"simple tabs example\"\n          style={{minHeight:\"10%\"}}\n        >\n          {\n            uniqueCategories.map((category, idx) => {\n              return (\n                <Tab label={category} {...a11yProps(idx)} style={{minWidth:\"20%\", minHeight:\"10%\"}}/>\n              )\n            })\n          }\n          <Tab label=\"Params1\" {...a11yProps(uniqueCategories.length)} style={{minWidth:\"20%\", minHeight:\"10%\"}}/>\n        </Tabs>\n      </AppBar>\n      {\n        uniqueCategories.map((category, idx) => {\n          return (\n            <TabPanel value={value} index={idx}>\n              <div style={{overflowY: 'scroll', height: 0.52*window.innerHeight, margin: '0px'}}>\n              {createParameterWidgets(\n                contextValue.params, category, contextValue, autoApply\n              )}\n              </div>\n            </TabPanel>\n          )\n        })\n      }\n      <TabPanel value={value} index={uniqueCategories.length}>\n        <div style={{overflowY: 'scroll', height: 0.52*window.innerHeight, margin: '0px'}}>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n          <div><Button>tab111</Button></div>\n        </div>\n      </TabPanel>\n      <Checkbox\n        checked={autoApply}\n        id=\"auto_apply_check\"\n        onChange={e => {setAutoApply(e.target.checked)}}\n      />\n      Auto Apply\n      <Button variant='contained' style={{'float': \"right\", marginTop: \"10px\"}}>Apply</Button>\n    </div>\n  )\n}\n\nexport default ParameterSettingsTab;\n","/* eslint-disable */\nimport {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.05;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t// Touch fingers\n\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t// the target DOM element for key events\n\tthis._domElementKeyEvents = null;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\tthis._domElementKeyEvents = domElement;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().invert();\n\n\t\tvar lastPosition = new Vector3();\n\t\tvar lastQuaternion = new Quaternion();\n\n\t\tvar twoPI = 2 * Math.PI;\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t} else {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t}\n\n\t\t\t// restrict theta to be between desired limits\n\n\t\t\tvar min = scope.minAzimuthAngle;\n\t\t\tvar max = scope.maxAzimuthAngle;\n\n\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t}\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove );\n\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t}\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: - 1,\n\t\tROTATE: 0,\n\t\tDOLLY: 1,\n\t\tPAN: 2,\n\t\tTOUCH_ROTATE: 3,\n\t\tTOUCH_PAN: 4,\n\t\tTOUCH_DOLLY_PAN: 5,\n\t\tTOUCH_DOLLY_ROTATE: 6\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new Spherical();\n\tvar sphericalDelta = new Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new Vector2();\n\tvar rotateEnd = new Vector2();\n\tvar rotateDelta = new Vector2();\n\n\tvar panStart = new Vector2();\n\tvar panEnd = new Vector2();\n\tvar panDelta = new Vector2();\n\n\tvar dollyStart = new Vector2();\n\tvar dollyEnd = new Vector2();\n\tvar dollyDelta = new Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\tvar needsUpdate = false;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.update();\n\n\t\t}\n\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchStartPan( event );\n\n\t}\n\n\tfunction handleTouchStartDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchStartRotate( event );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateEnd.set( x, y );\n\n\t\t}\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanEnd.set( x, y );\n\n\t\t}\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyOut( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t}\n\n\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t}\n\n\tfunction handleTouchEnd( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onPointerDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tonMouseDown( event );\n\t\t\t\tbreak;\n\n\t\t\t// TODO touch\n\n\t\t}\n\n\t}\n\n\tfunction onPointerMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tonMouseMove( event );\n\t\t\t\tbreak;\n\n\t\t\t// TODO touch\n\n\t\t}\n\n\t}\n\n\tfunction onPointerUp( event ) {\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tonMouseUp( event );\n\t\t\t\tbreak;\n\n\t\t\t// TODO touch\n\n\t\t}\n\n\t}\n\n\tfunction onMouseDown( event ) {\n\n\t\t// Prevent the browser from scrolling.\n\t\tevent.preventDefault();\n\n\t\t// Manually set the focus since calling preventDefault above\n\t\t// prevents the browser from setting it automatically.\n\n\t\tscope.domElement.focus ? scope.domElement.focus() : window.focus();\n\n\t\tvar mouseAction;\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0:\n\n\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\n\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tmouseAction = - 1;\n\n\t\t}\n\n\t\tswitch ( mouseAction ) {\n\n\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase MOUSE.PAN:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault(); // prevent scrolling\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault(); // prevent scrolling\n\t\tevent.stopPropagation();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove );\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( EventDispatcher.prototype );\nOrbitControls.prototype.constructor = OrbitControls;\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nvar MapControls = function ( object, domElement ) {\n\n\tOrbitControls.call( this, object, domElement );\n\n\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\tthis.touches.ONE = TOUCH.PAN;\n\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n};\n\nMapControls.prototype = Object.create( EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nexport { OrbitControls, MapControls };\n","class VRButton {\n\n\tstatic createButton( renderer, options ) {\n\n\t\tif ( options ) {\n\n\t\t\tconsole.error( 'THREE.VRButton: The \"options\" parameter has been removed. Please set the reference space type via renderer.xr.setReferenceSpaceType() instead.' );\n\n\t\t}\n\n\t\tconst button = document.createElement( 'button' );\n\n\t\tfunction showEnterVR( /*device*/ ) {\n\n\t\t\tlet currentSession = null;\n\n\t\t\tfunction onSessionStarted( session ) {\n\n\t\t\t\tsession.addEventListener( 'end', onSessionEnded );\n\n\t\t\t\trenderer.xr.setSession( session );\n\t\t\t\tbutton.textContent = 'EXIT VR';\n\n\t\t\t\tcurrentSession = session;\n\n\t\t\t}\n\n\t\t\tfunction onSessionEnded( /*event*/ ) {\n\n\t\t\t\tcurrentSession.removeEventListener( 'end', onSessionEnded );\n\n\t\t\t\tbutton.textContent = 'ENTER VR';\n\n\t\t\t\tcurrentSession = null;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'pointer';\n\t\t\tbutton.style.left = 'calc(50% - 50px)';\n\t\t\tbutton.style.width = '100px';\n\n\t\t\tbutton.textContent = 'ENTER VR';\n\n\t\t\tbutton.onmouseenter = function () {\n\n\t\t\t\tbutton.style.opacity = '1.0';\n\n\t\t\t};\n\n\t\t\tbutton.onmouseleave = function () {\n\n\t\t\t\tbutton.style.opacity = '0.5';\n\n\t\t\t};\n\n\t\t\tbutton.onclick = function () {\n\n\t\t\t\tif ( currentSession === null ) {\n\n\t\t\t\t\t// WebXR's requestReferenceSpace only works if the corresponding feature\n\t\t\t\t\t// was requested at session creation time. For simplicity, just ask for\n\t\t\t\t\t// the interesting ones as optional features, but be aware that the\n\t\t\t\t\t// requestReferenceSpace call will fail if it turns out to be unavailable.\n\t\t\t\t\t// ('local' is always available for immersive sessions and doesn't need to\n\t\t\t\t\t// be requested separately.)\n\n\t\t\t\t\tconst sessionInit = { optionalFeatures: [ 'local-floor', 'bounded-floor', 'hand-tracking' ] };\n\t\t\t\t\tnavigator.xr.requestSession( 'immersive-vr', sessionInit ).then( onSessionStarted );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcurrentSession.end();\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\tfunction disableButton() {\n\n\t\t\tbutton.style.display = '';\n\n\t\t\tbutton.style.cursor = 'auto';\n\t\t\tbutton.style.left = 'calc(50% - 75px)';\n\t\t\tbutton.style.width = '150px';\n\n\t\t\tbutton.onmouseenter = null;\n\t\t\tbutton.onmouseleave = null;\n\n\t\t\tbutton.onclick = null;\n\n\t\t}\n\n\t\tfunction showWebXRNotFound() {\n\n\t\t\tdisableButton();\n\n\t\t\tbutton.textContent = 'VR NOT SUPPORTED';\n\n\t\t}\n\n\t\tfunction stylizeElement( element ) {\n\n\t\t\telement.style.position = 'absolute';\n\t\t\telement.style.bottom = '20px';\n\t\t\telement.style.padding = '12px 6px';\n\t\t\telement.style.border = '1px solid #fff';\n\t\t\telement.style.borderRadius = '4px';\n\t\t\telement.style.background = 'rgba(0,0,0,0.1)';\n\t\t\telement.style.color = '#fff';\n\t\t\telement.style.font = 'normal 13px sans-serif';\n\t\t\telement.style.textAlign = 'center';\n\t\t\telement.style.opacity = '0.5';\n\t\t\telement.style.outline = 'none';\n\t\t\telement.style.zIndex = '999';\n\n\t\t}\n\n\t\tif ( 'xr' in navigator ) {\n\n\t\t\tbutton.id = 'VRButton';\n\t\t\tbutton.style.display = 'none';\n\n\t\t\tstylizeElement( button );\n\n\t\t\tnavigator.xr.isSessionSupported( 'immersive-vr' ).then( function ( supported ) {\n\n\t\t\t\tsupported ? showEnterVR() : showWebXRNotFound();\n\n\t\t\t} );\n\n\t\t\treturn button;\n\n\t\t} else {\n\n\t\t\tconst message = document.createElement( 'a' );\n\n\t\t\tif ( window.isSecureContext === false ) {\n\n\t\t\t\tmessage.href = document.location.href.replace( /^http:/, 'https:' );\n\t\t\t\tmessage.innerHTML = 'WEBXR NEEDS HTTPS'; // TODO Improve message\n\n\t\t\t} else {\n\n\t\t\t\tmessage.href = 'https://immersiveweb.dev/';\n\t\t\t\tmessage.innerHTML = 'WEBXR NOT AVAILABLE';\n\n\t\t\t}\n\n\t\t\tmessage.style.left = 'calc(50% - 90px)';\n\t\t\tmessage.style.width = '180px';\n\t\t\tmessage.style.textDecoration = 'none';\n\n\t\t\tstylizeElement( message );\n\n\t\t\treturn message;\n\n\t\t}\n\n\t}\n\n}\n\nexport { VRButton };","import * as THREE from 'three';\n\n\nexport class ObjectFactory {\n\n  static createSphere(\n    pos_x: number = 0.0,\n    pos_y: number = 0.0,\n    pos_z: number = 0.0,\n    radius: number = 1.0,\n    opacity: number = 1.0,\n    color: number | string = 0x22DD22,\n    side: THREE.Side = THREE.FrontSide,\n    texture_filepath?: string,\n  ): THREE.Mesh {\n    const sphereRadius = radius;\n    const sphereGeometry = new THREE.SphereGeometry(sphereRadius, 20, 20);\n    let matArgs: any = {\n      color: color,\n      opacity: opacity,\n      transparent: true,\n      side: side,\n      depthWrite: false\n    };\n    if (texture_filepath !== undefined) {\n      matArgs['map'] = (new THREE.TextureLoader()).load(texture_filepath);\n    }\n    const sphereMaterial = new THREE.MeshLambertMaterial(matArgs);\n    const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);\n\n    sphere.position.x = pos_x;\n    sphere.position.y = pos_y;\n    sphere.position.z = pos_z;\n    sphere.castShadow = true;\n\n    return sphere;\n  }\n\n  static createBox(\n    pos_x: number = 0,\n    pos_y: number = 0,\n    pos_z: number = 0,\n    size_x: number = 1.0,\n    size_y: number = 1.0,\n    size_z: number = 1.0,\n    opacity: number = 1.0,\n    color: number | string = 0xff0000,\n    side: THREE.Side = THREE.FrontSide,\n    texture_filepath?: string,\n  ): THREE.Mesh {\n    let matArgs: any = {\n      color: color,\n      opacity: opacity,\n      transparent: true,\n      side: side,\n      depthWrite: false\n    };\n    if (texture_filepath !== undefined) {\n      matArgs['map'] = (new THREE.TextureLoader()).load(texture_filepath);\n    }\n    const box = new THREE.Mesh(\n        new THREE.BoxGeometry(size_x, size_y, size_z),\n        new THREE.MeshStandardMaterial(matArgs)\n    );\n    box.receiveShadow = true;\n\n    box.position.set(pos_x, pos_y, pos_z);\n    return box;\n  }\n\n  static createPlane(\n    pos_x: number = 0,\n    pos_y: number = 0,\n    pos_z: number = 0,\n    rotation_x: number = -0.5*Math.PI,\n    rotation_y: number = 0,\n    rotation_z: number = 0,\n    opacity: number = 1.0,\n    color: number | string = 0xffffff,\n    size_h: number = 3,\n    size_w:number = 3,\n    side: THREE.Side = THREE.DoubleSide,\n    texture_filepath?: string,\n  ): THREE.Mesh {\n    const planeGeometry = new THREE.PlaneGeometry(size_w, size_h, 1, 1);\n    let matArgs: any = {\n      color: color,\n      opacity: opacity,\n      transparent: true,\n      side: side\n    };\n    if (texture_filepath !== undefined) {\n      matArgs['map'] = (new THREE.TextureLoader()).load(texture_filepath);\n    }\n    const planeMaterial = new THREE.MeshStandardMaterial(matArgs);\n    const plane = new THREE.Mesh(planeGeometry, planeMaterial);\n    plane.receiveShadow = true;\n    plane.castShadow = true;\n\n    plane.rotation.set(rotation_x, rotation_y, rotation_z);\n    plane.position.set(pos_x, pos_y, pos_z);\n\n    return plane;\n  }\n\n  static createArrow(\n    name: string,\n    pos_x: number = 0,\n    pos_y: number = 0,\n    pos_z: number = 0,\n    dir_x: number = 0,\n    dir_y: number = 1,\n    dir_z: number = 0,\n    rotation_x: number = -Math.PI,\n    rotation_y: number = 0,\n    rotation_z: number = 0,\n    length: number = 0.8,\n    color: number | string = 0x00ff00,\n    headWidth: number = 0.3,\n    headLength: number = 0.3\n  ): THREE.ArrowHelper {\n    const dir = new THREE.Vector3(dir_x, dir_y, dir_z);\n    const pos = new THREE.Vector3(pos_x, pos_y, pos_z);\n    const arrowHelper = new THREE.ArrowHelper(dir, pos, length, color,\n                                              headWidth, headLength);\n    arrowHelper.name = name;\n    arrowHelper.rotation.x = rotation_x;\n    arrowHelper.rotation.y = rotation_y;\n    arrowHelper.rotation.z = rotation_z;\n\n    return arrowHelper;\n  }\n\n  static createSprite(\n    pos_x: number = 0,\n    pos_y: number = 0,\n    pos_z: number = 0,\n    scale: number = 0.2,\n    color: number | string = 0x0000ee,\n  ): THREE.Sprite {\n    const material = new THREE.SpriteMaterial({color: color});\n    const sprite = new THREE.Sprite(material);\n    sprite.position.x = pos_x;\n    sprite.position.y = pos_y;\n    sprite.position.z = pos_z;\n    sprite.scale.x = scale;\n    sprite.scale.y = scale;\n    sprite.scale.z = scale;\n\n    return sprite;\n  }\n\n  static createTorusKnot(\n    pos_x: number = 0,\n    pos_y: number = 0,\n    pos_z: number = 0,\n    radius: number = 1,\n    tube: number = 0.4,\n    tubularSegments: number = 64,\n    radiusSegments: number = 8,\n    p: number = 2,\n    q: number = 3,\n    opacity: number = 1.0,\n    color: number | string = 0x6699FF,\n    roughness: number = 0.5,\n    side: THREE.Side = THREE.FrontSide,\n    texture_filepath?: string,\n  ): THREE.Mesh {\n    const geometry = new THREE.TorusKnotGeometry(\n      radius, tube, tubularSegments, radiusSegments, p, q\n    )\n    let matArgs: any = {\n      color: color,\n      opacity: opacity,\n      transparent: true,\n      side: side,\n      roughness: roughness,\n    };\n    if (texture_filepath !== undefined) {\n      matArgs['map'] = (new THREE.TextureLoader()).load(texture_filepath);\n    }\n    const material = new THREE.MeshStandardMaterial(matArgs);\n    const torus = new THREE.Mesh(geometry, material);\n    torus.receiveShadow = true;\n    torus.castShadow = true;\n    torus.position.set(pos_x, pos_y, pos_z);\n    return torus\n  }\n\n}\n\nexport default ObjectFactory;\n","import React, { useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport * as THREE from 'three';\n\nimport { ThreeContext, ThreeContextValue } from '../../contexts/Contexts';\nimport { OrbitControls } from '../../utils/three/OrbitControls';\nimport { VRButton } from '../../utils/three/VRButton';\nimport { ThreeObject } from '../../types/Three';\nimport { Object } from '../../types/ObjectConfig';\nimport { ObjectFactory as OF } from '../../utils/three/ObjectFactory';\n\n\nexport interface Props {\n};\n\n\nexport const addObject = (contextValue: ThreeContextValue, obj: ThreeObject) => {\n  if (contextValue.objects === undefined) { return; }\n  for (let i = 0; i < contextValue.objects?.length; i++) {\n    const obj2 = contextValue.objects[i];\n    if (obj2.tag === obj.tag) {\n      return;\n    }\n  }\n  contextValue.objects?.push(obj);\n}\n\n\nexport const createThreeObjectsFromConfig = (objs: Object[]): ThreeObject[] => {\n  const threeObjs: ThreeObject[] = [];\n  objs.forEach(obj => {\n    if (obj.objType === \"sphere\") {\n      threeObjs.push({\n        tag: obj.name,\n        obj: OF.createSphere(\n          obj.pos.x, obj.pos.y, obj.pos.z,\n          obj.scale.x,\n          obj.opacity,\n          obj.color,\n          THREE.FrontSide,\n          obj.textureFilepath\n        ),\n        objType: obj.objType\n      })\n    } else if (obj.objType === \"plane\") {\n      threeObjs.push({\n        tag: obj.name,\n        obj: OF.createPlane(\n          obj.pos.x, obj.pos.y, obj.pos.z,\n          obj.rotation.x, obj.rotation.y, obj.rotation.z,\n          obj.opacity,\n          obj.color,\n          obj.scale.x, obj.scale.z,\n          THREE.DoubleSide,\n          obj.textureFilepath\n        ),\n        objType: obj.objType\n      })\n    }\n\n  });\n  return threeObjs;\n}\n\n\nexport const clearScene = (contextValue: ThreeContextValue) => {\n  if (contextValue.objects === undefined) { return; }\n  contextValue.objects = [];\n}\n\n\nexport const findThreeObj = (contextValue: ThreeContextValue, tag: string): ThreeObject|null => {\n  if (contextValue.objects === undefined) {\n    return null;\n  }\n  for (let i = 0; i < contextValue.objects?.length; ++i) {\n    if (contextValue.objects[i].tag === tag) {\n      return contextValue.objects[i];\n    }\n  }\n  return null;\n}\n\n\nconst ThreeBaseScene: React.FC<Props> = (props: Props) => {\n  console.log('ThreeBaseScene')\n\n  const contextValue = React.useContext(ThreeContext);\n\n  const _lookAt = contextValue.lookAt === undefined ?\n        new THREE.Vector3(0, 0, 0) :\n        new THREE.Vector3(contextValue.lookAt.x, contextValue.lookAt.y, contextValue.lookAt.z);\n\n  const [container, setContainer] = React.useState<HTMLDivElement|null>(null);\n  const [scene, setScene] = React.useState<THREE.Scene>(new THREE.Scene());\n  // const [camera, setCamera] = React.useState<THREE.PerspectiveCamera>(\n  //   new THREE.PerspectiveCamera(\n  //     45,\n  //     contextValue.width / contextValue.height,\n  //     0.1,\n  //     1000\n  //   )\n  // );\n  const [lookAt, setLookAt] = React.useState<THREE.Vector3>(_lookAt);\n  const [renderer, setRenderer] = React.useState<THREE.WebGLRenderer>(new THREE.WebGLRenderer({ antialias: true }));\n  const [bgColor, setBgColor] = React.useState<THREE.Color>(\n    contextValue.bgColor === undefined ? new THREE.Color('#b4bad2') : contextValue.bgColor\n  );\n  const [clock, setClock] = React.useState<THREE.Clock>(new THREE.Clock());\n  const [cnt, setCnt] = React.useState<number>(0);\n  const [orbitControls, setOrbitControls] = React.useState<OrbitControls|null>(null);\n  // const [objects, setObjects] = React.useState<ThreeObjects>([]);\n\n  // contextValue.camera.position.x = contextValue.camera.position.x;\n  // contextValue.camera.position.y = contextValue.camera.position.y;\n  // contextValue.camera.position.z = contextValue.camera.position.z;\n  contextValue.camera.lookAt(new THREE.Vector3(lookAt.x, lookAt.y, lookAt.z));\n  // setCamera(camera); NG\n\n  renderer.setSize(contextValue.width, contextValue.height);\n  renderer.setClearColor(bgColor);\n  renderer.shadowMap.enabled = true;\n\n  const update = (dt: number): void => {\n    if (contextValue.onUpdate) {\n      contextValue.onUpdate(dt);\n    }\n    if (contextValue.onUpdateChart) {\n      contextValue.onUpdateChart(dt);\n    }\n  }\n\n  const onReset = (): void => {\n    // Reset objects\n    scene.remove.apply(scene, scene.children);\n    if (contextValue.objects) {\n      contextValue.objects.map(obj => scene.add(obj.obj));\n    }\n\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);\n    scene.add(ambientLight);\n\n    const spotLight = new THREE.SpotLight(0xffffff, 2.0, 100, Math.PI / 4, 1);\n    spotLight.position.set(2, 7, 2);\n    spotLight.castShadow = true;\n    scene.add(spotLight);\n  }\n\n  useEffect(() => {\n    console.log('useeffect')\n    if (container) {\n      container.appendChild(renderer.domElement);\n      const _orbitControls = new OrbitControls(contextValue.camera, container);\n      _orbitControls.target.set(0, 0, 0);\n      _orbitControls.update();\n      setOrbitControls(_orbitControls);\n    }\n    renderer.setAnimationLoop(() => {\n      setCnt(cnt+1);\n      update(clock.getDelta());\n      renderer.render(scene, contextValue.camera);\n    })\n    ReactDOM.render(<div id='vr_button'/>, document.body.appendChild(VRButton.createButton( renderer )));\n  }, [container, clock, renderer, scene, contextValue.camera])\n\n  useEffect(() => {\n    console.log('useeffect2')\n    onReset();\n  }, [contextValue.objects])\n\n  return (\n    <div>\n      <div\n        style={{ width: contextValue.width, height: contextValue.height }}\n        ref={(container) => { setContainer(container) }}\n      />\n      <div id='vr_button'/>\n    </div>\n  )\n}\n\nexport default ThreeBaseScene;\n","import React, { useEffect } from 'react';\nimport * as THREE from 'three';\n\nimport ThreeBaseScene, { addObject } from './ThreeBaseScene';\nimport { ThreeContext, ThreeContextValue } from '../../contexts/Contexts';\nimport { ObjectFactory as OF } from '../../utils/three/ObjectFactory';\n\n\nexport interface Props {\n};\n\n\nconst CoordinateAxisScene: React.FC<Props> = (props: Props) => {\n\n  const contextValue = React.useContext(ThreeContext);\n  addObject(contextValue, {\n    tag: 'x_axis',\n    obj: OF.createArrow(\n      'x_axis',\n      0, 0, 0,\n      1.0, 0.0, 0.0,\n      0.5*Math.PI, 0.0, 0,\n      6.0, //this._axis_length,\n      0xFF0000,\n      0.5, //this._axis_length/5,\n      0.5, //this._axis_length/5,\n    ),\n    objType: 'arrow'\n  })\n  addObject(contextValue, {\n    tag: 'y_axis',\n    obj: OF.createArrow(\n      'y_axis',\n      0, 0, 0,\n      0.0, 1.0, 0.0,\n      0, 0.5*Math.PI, 0,\n      6.0,\n      0x00FF00,\n      0.6, 0.6,\n    ),\n    objType: 'arrow'\n  })\n  addObject(contextValue, {\n    tag: 'z_axis',\n    obj: OF.createArrow(\n      'z_axis',\n      0, 0, 0,\n      0.0, 0.0, 1.0,\n      0, 0, 0.5*Math.PI,\n      6.0,\n      0x0000FF,\n      0.6, 0.6,\n    ),\n    objType: 'arrow'\n  })\n\n  return (\n    <div>\n      <ThreeBaseScene />\n    </div>\n  )\n}\n\nexport default CoordinateAxisScene;\n","import React, { useEffect } from 'react';\nimport * as THREE from 'three';\n\nimport { addObject } from './ThreeBaseScene';\nimport CoordinateAxisScene from './CoordinateAxisScene';\nimport { ThreeContext, ThreeContextValue } from '../../contexts/Contexts';\nimport { ObjectFactory as OF } from '../../utils/three/ObjectFactory';\n\n\nexport interface Props {\n};\n\n\nconst TestBoxPlaneScene: React.FC<Props> = (props: Props) => {\n\n  const contextValue = React.useContext(ThreeContext);\n\n  addObject(contextValue, {\n    tag: 'box1',\n    obj: OF.createTorusKnot(\n      0.0, 0.2, 0.0,\n      // 0.1, 1, 6.7, 10, 3, 40\n    ),\n    objType: 'box'\n  });\n  addObject(contextValue, {\n    tag: 'plane1',\n    obj: OF.createPlane(\n      0, 0, 0,\n      -0.5*Math.PI, 0, 0,\n      0.6,\n      0xffffff,\n      10, 10,\n      THREE.DoubleSide,\n      'https://threejsfundamentals.org/threejs/resources/images/wall.jpg'\n    ),\n    objType: 'plane'\n  });\n\n  return (\n    <div>\n      <CoordinateAxisScene />\n    </div>\n  )\n}\n\nexport default TestBoxPlaneScene;\n","import { Scatter as ChartJSScatter } from 'react-chartjs-2';\n\n\nexport type ChartType =\n  \"SCATTER_2D\" |\n  \"SCATTER_3D\" |\n  \"LINE_2D\" |\n  \"LINE_3D\" |\n  \"HISTOGRAM\"\n;\n\nexport const ChartTypeList = [\n  \"SCATTER_2D\",\n  \"SCATTER_3D\",\n  \"LINE_2D\",\n  \"LINE_3D\",\n  \"HISTOGRAM\"\n]\n\nexport type ChartJSType = typeof ChartJSScatter;\n","import React from 'react';\nimport { Scatter as ChartScatter } from 'react-chartjs-2';\nimport styled from 'styled-components';\nimport { ChartContext, ChartContextValue } from '../../../contexts/Contexts';\n\n\nconst StyledChart = styled.div`\n  // position: fixed;\n  top: 0;\n  right: 0;\n  width: 40%;\n`\n\ninterface Data2D {\n  x: number,\n  y: number,\n};\n\nexport type DataType2D = Data2D[];\n\ntype Props= {\n  data: DataType2D,\n  tag: string\n}\n\n\nexport const Scatter2D: React.FC<Props> = (props: Props) => {\n\n  const chartContextValue = React.useContext(ChartContext);\n\n  const data = {\n    labels: ['Scatter'],\n    datasets: [\n      {\n        label: 'data',\n        fill: true,\n        backgroundColor: 'rgba(75,192,192,0.4)',\n        pointBorderColor: 'rgba(75,192,192,1)',\n        pointBackgroundColor: '#fff',\n        pointBorderWidth: 2,\n        pointHoverRadius: 1,\n        pointHoverBackgroundColor: 'rgba(75,192,192,1)',\n        pointHoverBorderColor: 'rgba(220,220,220,1)',\n        pointHoverBorderWidth: 2,\n        pointRadius: 2,\n        pointHitRadius: 5,\n        data: props.data,\n      }\n    ]\n  };\n  const options = {\n    responsive: true,\n    legend: {\n      display: true\n    },\n    animation: {\n      duration: 0\n    }\n  }\n\n  return (\n    // <StyledChart>\n      <ChartScatter\n        data={data}\n        options={options}\n        redraw={true}\n        ref={(ref) => {\n          if (chartContextValue.chartRefs !== undefined && chartContextValue.setChartRefs !== undefined) {\n            const refs: any = chartContextValue.chartRefs;\n            refs[props.tag] = ref;\n            chartContextValue.setChartRefs(refs);\n            console.log(refs);\n          }\n        }}\n      />\n    // </StyledChart>\n  )\n\n}\n\n// export default Scatter;\n","import React, { useState } from 'react';\nimport Select, { SelectChangeEvent } from '@mui/material/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Grid, { GridSize } from '@material-ui/core/Grid';\n\nimport { ChartType, ChartTypeList } from '../../types/Chart';\nimport { Scatter2D, DataType2D } from './chartjs/Scatter';\nimport { ChartContext, ChartContextValue } from '../../contexts/Contexts';\nimport { BaseSystem } from '../../simulator/systems/BaseSystem';\n\n\nexport type ConfigurableChartData = {\n  [variable: string]: number[]\n}\n\n\nexport interface Props {\n  data: ConfigurableChartData,\n  variables: string[],\n  tag: string,\n};\n\n\nconst chart = (\n  chartType: ChartType|null,\n  data: ConfigurableChartData,\n  variableX: string, variableY: string, variableZ: string,\n  tag: string,\n) => {\n  let data_ = [];\n  if (variableX !== undefined && variableY !== undefined && variableZ !== undefined) {\n    data_ = convertChartDataFormat(data, variableX, variableY, variableZ);\n  } else if (variableX !== undefined && variableY !== undefined) {\n    data_ = convertChartDataFormat(data, variableX, variableY);\n  }\n  if (chartType === \"SCATTER_2D\") {\n    return (\n      <Scatter2D\n        data={data_}\n        tag={tag}\n      >\n      </Scatter2D>\n    )\n  } else {\n    return (\n      <div style={{'color': \"#FF0000\"}}>Not Implemented</div>\n    )\n  }\n}\n\nconst numSelectableVariables = (chartType: ChartType|null|\"\"): number => {\n  if (chartType === null || chartType === \"\") {\n    return 0;\n  } else if (chartType === \"LINE_3D\" || chartType === \"SCATTER_3D\") {\n    return 3;\n  } else if (chartType === \"HISTOGRAM\") {\n    return 1;\n  } else {\n    return 2;\n  }\n}\n\nconst headerWidgets = (\n  variables: string[],\n  numVariables: number,\n  chartType: ChartType|null|\"\",\n  setChartType: React.Dispatch<React.SetStateAction<ChartType | null>>,\n  variableX: string,\n  variableY: string,\n  variableZ: string,\n  setVariableX: React.Dispatch<React.SetStateAction<string>>,\n  setVariableY: React.Dispatch<React.SetStateAction<string>>,\n  setVariableZ: React.Dispatch<React.SetStateAction<string>>,\n) => {\n  if (numVariables === 0) {\n    return (\n      <Grid container spacing={0} direction=\"row\">\n        <Grid item xs={4}>\n          <InputLabel htmlFor=\"chart-type-select\">Chart Type</InputLabel>\n          <Select\n            onChange={(event: SelectChangeEvent) => {\n              setChartType(event.target.value as ChartType);\n            }}\n            // displayEmpty\n            label=\"chart_type\"\n            value={chartType as string}\n            variant=\"outlined\"\n            style={{height: \"30px\", fontSize: \"0.7em\"}}\n          >\n            <MenuItem value=\"\">\n              <em>None</em>\n            </MenuItem>\n            {ChartTypeList.map((v) => (\n              <MenuItem value={v}>\n                {v}\n              </MenuItem>\n            ))}\n          </Select>\n        </Grid>\n      </Grid>\n    )\n  }\n\n  const s = 12 / (numVariables+1);\n  const xyzSelect = (label: string, variable: string, setVariable: React.Dispatch<React.SetStateAction<string>>) => {\n    return (\n      <Select\n        onChange={(event: SelectChangeEvent) => {\n          setVariable(event.target.value);\n        }}\n        // displayEmpty\n        label={label}\n        value={variable}\n        variant=\"outlined\"\n        style={{height: \"30px\"}}\n      >\n        {variables.map((v) => (\n          <MenuItem value={v}>\n            {v}\n          </MenuItem>\n        ))}\n      </Select>\n    )\n  }\n\n  return (\n    <Grid container spacing={0} direction=\"row\">\n      <Grid item xs={s as GridSize}>\n        <InputLabel htmlFor=\"chart-type-select\">Chart Type</InputLabel>\n        <Select\n          onChange={(event: SelectChangeEvent) => {\n            setChartType(event.target.value as ChartType);\n          }}\n          // displayEmpty\n          label=\"chart_type\"\n          value={chartType as string}\n          variant=\"outlined\"\n          style={{height: \"30px\"}}\n        >\n          <MenuItem value=\"\">\n            <em>None</em>\n          </MenuItem>\n          {ChartTypeList.map((v) => (\n            <MenuItem value={v}>\n              {v}\n            </MenuItem>\n          ))}\n        </Select>\n      </Grid>\n      <Grid item xs={s as GridSize}>\n        <InputLabel htmlFor=\"chart-type-select\">X</InputLabel>\n        {xyzSelect(\"variable_x\", variableX, setVariableX)}\n      </Grid>\n      {\n        (() => {\n          if (chartType !== \"HISTOGRAM\") {\n            return (\n              <Grid item xs={s as GridSize}>\n                <InputLabel htmlFor=\"chart-type-select\">Y</InputLabel>\n                {xyzSelect(\"variable_y\", variableY, setVariableY)}\n              </Grid>\n            )\n          }\n        })()\n      }\n      {\n        (() => {\n          if (numVariables === 3) {\n            return (\n              <Grid item xs={s as GridSize}>\n                <InputLabel htmlFor=\"chart-type-select\">Z</InputLabel>\n                {xyzSelect(\"variable_z\", variableZ, setVariableZ)}\n              </Grid>\n            )\n          }\n        })()\n      }\n    </Grid>\n  )\n}\n\n\nexport const convertChartDataFormat = (\n  data: ConfigurableChartData,\n  x_variable: string,\n  y_variable?: string,\n  z_variable?: string\n) => {\n  return data[x_variable].map((v, idx) => {\n    let d: any = {}\n    d[\"x\"] = v;\n    if (y_variable) {\n      d[\"y\"] = data[y_variable][idx];\n    }\n    if (z_variable) {\n      d[\"z\"] = data[z_variable][idx];\n    }\n    return d;\n  })\n}\n\n\nconst ConfigurableChart: React.FC<Props> = (props: Props) => {\n\n  const [chartType, setChartType] = useState<ChartType|null>(\"SCATTER_2D\");\n  const [variableX, setVariableX] = useState<string>(props.variables[0]);\n  const [variableY, setVariableY] = useState<string>(props.variables[0]);\n  const [variableZ, setVariableZ] = useState<string>(props.variables[0]);\n\n  const contextValue = React.useContext(ChartContext);\n\n  const nv = numSelectableVariables(chartType);\n\n  if (contextValue !== undefined &&\n      contextValue.onSceneUpdateChartCallbacks !== undefined) {\n    const onSceneUpdate = contextValue.onSceneUpdateChartCallbacks;\n    onSceneUpdate[props.tag] = (dt: number, simulator?: BaseSystem) => {\n      if (contextValue !== undefined &&\n          contextValue.chartRefs !== undefined &&\n          contextValue.chartRefs[props.tag] &&\n          simulator !== undefined) {\n        let data_ = [];\n        if (variableX !== undefined && variableY !== undefined && variableZ !== undefined) {\n          data_ = convertChartDataFormat(simulator.historicalData(), variableX, variableY, variableZ);\n        } else if (variableX !== undefined && variableY !== undefined) {\n          data_ = convertChartDataFormat(simulator.historicalData(), variableX, variableY);\n        }\n        (contextValue.chartRefs[props.tag] as any).data.datasets[0].data = data_;//[{'x': Math.random(), 'y': Math.random()}];\n        (contextValue.chartRefs[props.tag] as any).update();\n      }\n    }\n  }\n\n  return (\n    <div>\n      {headerWidgets(\n        props.variables, nv, chartType, setChartType,\n        variableX, variableY, variableZ,\n        setVariableX, setVariableY, setVariableZ\n      )}\n      {chart(chartType, props.data, variableX, variableY, variableZ, props.tag)}\n    </div>\n  )\n}\n\nexport default ConfigurableChart;\n","import { Parameter, ParameterType } from '../../../types/Parameter';\n\n\nexport const FreeFallingParameters: Parameter[] = [\n  {\n    category: \"GENERAL\",\n    name: \"\",\n    id: \"gravitational_acceleration\",\n    parameterType: \"SLIDER_FLOAT\",\n    value: 9.8,\n    minValue: 0.0,\n    maxValue: 100,\n  },\n  {\n    category: \"GENERAL\",\n    name: \"()\",\n    id: \"initial_height\",\n    parameterType: \"NUMBER_IMPUT\",\n    value: 6,\n  },\n  {\n    category: \"GENERAL\",\n    name: \"\",\n    id: \"ground_height\",\n    parameterType: \"SLIDER_FLOAT\",\n    value: 0.0,\n    minValue: -40.0,\n    maxValue: 40.0,\n  },\n  {\n    category: \"GENERAL\",\n    name: \"\",\n    id: \"ball_radius\",\n    parameterType: \"SLIDER_FLOAT\",\n    value: 0.5,\n    minValue: 0.1,\n    maxValue: 10,\n  },\n  {\n    category: \"GENERAL\",\n    name: \"\",\n    id: \"restitution_coefficient\",\n    parameterType: \"SLIDER_FLOAT\",\n    value: 0.8,\n    minValue: 0.0,\n    maxValue: 1,\n  },\n  {\n    category: \"GENERAL\",\n    name: \"\",\n    id: \"air_resistance_coefficient\",\n    parameterType: \"SLIDER_FLOAT\",\n    value: 0.0,\n    minValue: 0.0,\n    maxValue: 10.0,\n  },\n  {\n    category: \"GENERAL\",\n    name: \"\",\n    id: \"ball_mass\",\n    parameterType: \"SLIDER_FLOAT\",\n    value: 1.0,\n    minValue: 0.1,\n    maxValue: 50.0,\n  },\n]\n","import * as THREE from 'three';\n\nimport { Object } from '../../../types/ObjectConfig';\n\n\nexport const FreeFallingObjects: Object[] = [\n  {\n    \"name\": \"ball1\",\n    \"objType\": \"sphere\",\n    \"pos\": new THREE.Vector3(0.0, 5.0, 0.0),\n    \"vel\": new THREE.Vector3(0.0, 0.0, 0.0),\n    \"rotation\": new THREE.Vector3(0.0, 0.0, 0.0),\n    \"scale\": new THREE.Vector3(0.5, 0.5, 0.5),\n    \"color\": \"#FF0000\",\n    \"mass\": 1.0,\n    \"opacity\": 0.8,\n  },\n  {\n    \"name\": \"ground1\",\n    \"objType\": \"plane\",\n    \"pos\": new THREE.Vector3(0.0, 0.0, 0.0),\n    \"vel\": new THREE.Vector3(0.0, 0.0, 0.0),\n    \"rotation\": new THREE.Vector3(-0.5*Math.PI, 0.0, 0.0),\n    \"scale\": new THREE.Vector3(20.0, 1.0, 20.0),\n    \"color\": \"#0xffffff\",\n    \"mass\": 1.0,\n    \"opacity\": 0.6,\n    \"textureFilepath\": 'https://threejsfundamentals.org/threejs/resources/images/wall.jpg'\n  },\n];\n","import { BaseSystem, ObjectState } from \"./BaseSystem\";\nimport { FreeFallingObjects } from \"../../scene_settings/samples/free_falling/FreeFallingObjects\";\nimport { FreeFallingParameters } from \"../../scene_settings/samples/free_falling/FreeFallingParameters\";\n\n\nexport class BouncingBallSystem extends BaseSystem {\n\n  private _ballObjIdx: number;\n  private _groundObjIdx: number;\n\n  private _gaCoefIdx: number;\n  private _ballRadiusIdx: number;\n  private _groundHeightIdx: number;\n  private _restitutionCoeffIdx: number;\n  private _airRessistanceCoefIdx: number;\n  private _initialHeightIdx: number;\n  private _massIdx: number;\n\n  private _ballPosys: number[] = [];\n  private _ballVelys: number[] = [];\n  private _energies: number[] = [];\n\n  constructor() {\n    super(FreeFallingObjects, FreeFallingParameters);\n    this._ballObjIdx = this.findObjIndex(\"ball1\");\n    this._groundObjIdx = this.findObjIndex(\"ground1\");\n\n    this._gaCoefIdx = this.findParamIndex(\"gravitational_acceleration\");\n    this._groundHeightIdx = this.findParamIndex(\"ground_height\");\n    this._ballRadiusIdx = this.findParamIndex(\"ball_radius\");\n    this._restitutionCoeffIdx = this.findParamIndex(\"restitution_coefficient\");\n    this._airRessistanceCoefIdx = this.findParamIndex(\"air_resistance_coefficient\");\n    this._initialHeightIdx = this.findParamIndex(\"initial_height\");\n    this._massIdx = this.findParamIndex(\"ball_mass\");\n    this.reset();\n  }\n\n  override _update(dt: number): void {\n    if (!this._is_running) {\n      return;\n    }\n    const mass = this._systemParams[this._massIdx].value as number;\n    // Update ball state by euler method.\n    this._objStates[this._ballObjIdx].vel.y += dt*this.gravitationalForce()/mass;\n    this._objStates[this._ballObjIdx].pos.y += dt*this._objStates[this._ballObjIdx].vel.y;\n    this._objStates[this._ballObjIdx].pos.x += dt*this._objStates[this._ballObjIdx].vel.x;\n    this._objStates[this._ballObjIdx].pos.z += dt*this._objStates[this._ballObjIdx].vel.z;\n    const ballRadius = this._systemParams[this._ballRadiusIdx].value as number;\n    const groundHeight = this._systemParams[this._groundHeightIdx].value as number;\n    const restitutionCoeff = this._systemParams[this._restitutionCoeffIdx].value as number;\n    if (this._objStates[this._ballObjIdx].pos.y - ballRadius < groundHeight) {\n      this._objStates[this._ballObjIdx].pos.y = groundHeight + ballRadius;\n      this._objStates[this._ballObjIdx].vel.y *= -restitutionCoeff;\n    }\n    this._ballPosys.push(this._objStates[this._ballObjIdx].pos.y);\n    if (this._ballPosys.length > this.MAX_QUEUE) {\n      this._ballPosys.shift();\n    }\n    this._ballVelys.push(this._objStates[this._ballObjIdx].vel.y);\n    if (this._ballVelys.length > this.MAX_QUEUE) {\n      this._ballVelys.shift();\n    }\n    this._energies.push(this.energy());\n    if (this._energies.length > this.MAX_QUEUE) {\n      this._energies.shift();\n    }\n  }\n\n  getStates(t?: number): ObjectState[] {\n    if (t !== undefined) {\n      throw new Error(\"Method not implemented.\");\n    }\n    // always return latest states for now.\n    return this._objStates;\n  }\n\n  getBallHeight(): number {\n    return this._objStates[this._ballObjIdx].pos.y;\n  }\n\n  getGroundHeight(): number {\n    return this._systemParams[this._groundHeightIdx].value as number;\n  }\n\n  getBallRadius(): number {\n    return this._systemParams[this._ballRadiusIdx].value as number;\n  }\n\n  private gravitationalForce(): number {\n    // Fy = -mg - k*vy^2\n    const mass = this._systemParams[this._massIdx].value as number;\n    const gaCoef = this._systemParams[this._gaCoefIdx].value as number;\n    const airRessistanceCoef = this._systemParams[this._airRessistanceCoefIdx].value as number;\n    return -mass*gaCoef - airRessistanceCoef*this._objStates[this._ballObjIdx].vel.y**2;\n  }\n\n  private energy(): number {\n    const mass = this._systemParams[this._massIdx].value as number;\n    const gaCoef = this._systemParams[this._gaCoefIdx].value as number;\n    return 0.5*mass*this._objStates[this._ballObjIdx].vel.y**2 + mass*gaCoef*this._objStates[this._ballObjIdx].pos.y\n  }\n\n  override reset(): void {\n    super.reset();\n    if (this._ballObjIdx !== undefined) {\n      this._objStates[this._ballObjIdx].pos.y = parseFloat(this._systemParams[this._initialHeightIdx].value as string);\n      this._objStates[this._ballObjIdx].vel.y = 0.0;\n    }\n    this._ballVelys.splice(0);\n    this._ballPosys.splice(0);\n  }\n\n  override historicalData() {\n    let data: any = super.historicalData();\n    data['ball_pos_y'] = this._ballPosys;\n    data['ball_vel_y'] = this._ballVelys;\n    data['energy'] = this._energies;\n    return data;\n  }\n}","import clone from \"clone\";\n\nimport { ThreeObject } from '../../types/Three';\nimport { Object } from '../../types/ObjectConfig';\nimport { Parameter } from '../../types/Parameter';\n\n\n// export type ObjectState = {\n//   'obj': ThreeObject,\n//   'state': Object\n// }\nexport type ObjectState = Object;\n\n\nexport abstract class BaseSystem {\n  protected _t: number = 0.0;\n  protected _is_running: boolean = false;\n  protected _initialObjStates: ObjectState[] = [];\n  protected _objStates: ObjectState[] = [];\n  protected _systemParams: Parameter[] = [];\n  protected MAX_DT: number = 0.1;\n  protected MAX_QUEUE: number = 2000;\n\n  protected _ts: number[] = []\n\n  constructor(\n    initialObjStates: ObjectState[],\n    systemParams: Parameter[],\n  ) {\n    this._initialObjStates = initialObjStates;\n    this._objStates = clone(initialObjStates);\n    this._systemParams = clone(systemParams);\n    //this.reset();\n  }\n\n  /*\n    Update system by dt.\n  */\n  update(dt: number): void {\n    if (this._is_running) {\n      this._t += dt;\n      this._update(Math.min(dt, this.MAX_DT))\n      this._ts.push(this._t);\n      if (this._ts.length > this.MAX_QUEUE) {\n        this._ts.shift();\n      }\n    }\n  }\n\n  /*\n    Update each object's state in the system by dt.\n    Subclass must overrides this method.\n  */\n  abstract _update(dt: number): void;\n\n  /*\n    Get each object's state in the system at t.\n    Returns latest states if t is not specified.\n    Subclass must implements this method.\n  */\n  abstract getStates(t?: number): ObjectState[];\n\n  reset(initialObjStates?: ObjectState[]): void {\n    this._t = 0.0;\n    this._is_running = false;\n    if (initialObjStates !== undefined) {\n      this._initialObjStates = initialObjStates;\n      this._objStates = clone(initialObjStates);\n    } else {\n      this._objStates = clone(this._initialObjStates);\n    }\n    this._ts.splice(0);\n    console.log(\"simulator reset\");\n  }\n\n  stop(): void {\n    console.log(\"stopped running\");\n    this._is_running = false;\n  }\n\n  start(): void {\n    console.log(\"started running\");\n    this._is_running = true;\n  }\n\n  setSystemParams(systemParams: Parameter[]): void {\n    this._systemParams = clone(systemParams);\n  }\n\n  isRunning(): boolean {\n    return this._is_running;\n  }\n\n  protected findObjIndex(name: string): number {\n    for (let i = 0; i < this._objStates?.length; ++i) {\n      if (this._objStates[i][\"name\"] === name) {\n        return i;\n      }\n    }\n    throw new Error(`Object with name ${name} not found.`);\n  }\n\n  protected findParamIndex(name: string): number {\n    for (let i = 0; i < this._systemParams?.length; ++i) {\n      if (this._systemParams[i][\"id\"] === name) {\n        return i;\n      }\n    }\n    throw new Error(`Parameter with name ${name} not found.`);\n  }\n\n  historicalData() {\n    return {\n      'time': this._ts\n    }\n  }\n}\n","import React, { useEffect, useState } from 'react';\nimport * as THREE from 'three';\n\nimport {\n  addObject,\n  createThreeObjectsFromConfig,\n  clearScene,\n  findThreeObj,\n} from './ThreeBaseScene';\nimport CoordinateAxisScene from './CoordinateAxisScene';\nimport { ThreeContext } from '../../contexts/Contexts';\nimport { FreeFallingObjects } from '../../scene_settings/samples/free_falling/FreeFallingObjects';\nimport { BouncingBallSystem } from '../../simulator/systems/BouncingBallSystem';\nimport { ThreeObject } from '../../types/Three';\n\n\nexport interface Props {\n};\n\n//const system = new BouncingBallSystem();\n\nconst BouncingBallScene: React.FC<Props> = (props: Props) => {\n\n  const [system, setSystem] = useState<BouncingBallSystem>(new BouncingBallSystem());\n  const [ballThreeObj, setBallThreeObj] = useState<ThreeObject|null>(null);\n  const [groundThreeObj, setGroundThreeObj] = useState<ThreeObject|null>(null);\n\n  const contextValue = React.useContext(ThreeContext);\n\n  contextValue.onUpdate = (dt: number) => {\n    system.update(dt);\n    if (ballThreeObj !== null && ballThreeObj?.obj !== null) {\n      const ballHeight = system.getBallHeight();\n      ballThreeObj.obj.position.y = ballHeight;\n      ballThreeObj.obj.scale.y = 2*system.getBallRadius();\n      ballThreeObj.obj.scale.x = 2*system.getBallRadius();\n      ballThreeObj.obj.scale.z = 2*system.getBallRadius();\n    }\n    if (groundThreeObj !== null && groundThreeObj?.obj !== null) {\n      groundThreeObj.obj.position.y = system.getGroundHeight();\n    }\n  }\n\n  if (contextValue.setSimulator !== undefined) {\n    contextValue.setSimulator(system);\n  }\n  const threeObjs = createThreeObjectsFromConfig(FreeFallingObjects);\n  threeObjs.map(obj => {addObject(contextValue, obj)});\n  console.log(threeObjs)\n  //system.start();\n\n  useEffect(() => {\n    setBallThreeObj(findThreeObj(contextValue, \"ball1\"));\n    setGroundThreeObj(findThreeObj(contextValue, \"ground1\"));\n    return () => {\n      console.log(\"clearing all\")\n      system.stop();\n      // clearScene(contextValue);\n      contextValue.onUpdate = undefined;\n      if (contextValue.setSimulator !== undefined) {\n        contextValue.setSimulator(undefined);\n      }\n    }\n  }, [system, ballThreeObj])\n\n  return (\n    <div>\n      <CoordinateAxisScene />\n    </div>\n  )\n}\n\nexport default BouncingBallScene;\n","import React, { useEffect } from 'react';\nimport { Container } from '@material-ui/core';\n// import Paper from '@mui/material/Paper';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Select, { SelectChangeEvent } from '@mui/material/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ListSubheader from '@mui/material/ListSubheader';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Button from '@mui/material/Button';\nimport * as THREE from 'three';\n\nimport SideMenu from '../layouts/SideMenu';\nimport ParameterSettingsTab from '../components/parameter_settings/ParameterSettingsTab';\nimport CoordinateAxisScene from '../components/scene/CoordinateAxisScene';\nimport TestBoxPlaneScene from '../components/scene/TestBoxPlaneScene';\nimport { ThreeContext, ParameterContext, ChartContext } from '../contexts/Contexts';\nimport { ThreeObjects, Vec3 } from '../types/Three';\nimport ConfigurableChart from '../components/chart/ConfigurableChart';\nimport { FreeFallingParameters } from '../scene_settings/samples/free_falling/FreeFallingParameters';\nimport BouncingBallScene from '../components/scene/BouncingBallScene';\nimport { BaseSystem } from '../simulator/systems/BaseSystem';\nimport { Parameter } from '../types/Parameter';\nimport { ChartJSType } from '../types/Chart';\n\n\ntype Props = {\n}\n\nconst PhysicalSimulation: React.FC<Props> = (props: Props) => {\n\n  const [scenes, setScenes] = React.useState<string[]>(\n    [\"CoordinateAxisScene\", \"TestBoxPlaneScene\", \"BouncingBallScene\", \"Scene3\"]\n  );\n  const [selectedScene, setSelectedScene] = React.useState<string>(\"BouncingBallScene\");\n  const [threeObjs, setThreeObjs] = React.useState<ThreeObjects>([]);\n  const [simulator, setSimulator] = React.useState<BaseSystem>();\n  const [camera, setCamera] = React.useState<THREE.PerspectiveCamera>((() => {\n    const cam = new THREE.PerspectiveCamera(\n      45,\n      (0.55*window.innerWidth) / ( 0.6*window.innerHeight),\n      0.1,\n      1000\n    )\n    cam.position.x = 10.0;\n    cam.position.y = 10.0;\n    cam.position.z = 10.0;\n    return cam\n  })());\n  const [runStopBtnText, setRunStopBtnText] = React.useState<\"RUN\"|\"STOP\">(\"RUN\");\n  const [selectableVariables, setSelectableVariables] = React.useState<string[]>([]);\n  const [chartRefs, setChartRefs] = React.useState<{[tag: string]: React.Ref<ChartJSType>}>({});\n  const [onSceneUpdateChartCallbacks, setOnSceneUpdateChartCallbacks] =\n      React.useState<{[tag: string]: (dt: number, simulator?: BaseSystem) => void}>({});\n\n  const scene2Params = (sceneName: string) => {\n    if (sceneName === \"BouncingBallScene\") {\n      return FreeFallingParameters;\n    } else {\n      return [];\n    }\n  }\n\n  useEffect(() => {\n    if (simulator) {\n      const data = simulator.historicalData();\n      const varibles: string[] = Object.keys(data);\n      setSelectableVariables(varibles);\n      console.log(varibles)\n    }\n  }, [simulator]);\n\n  let cnt = 0;\n  const onSceneUpdate = (dt: number) => {\n    // console.log(dt);\n    cnt += 1;\n    if (simulator && simulator.isRunning() && cnt % 10 == 0) {\n      if (onSceneUpdateChartCallbacks[\"chart1\"]) {\n        onSceneUpdateChartCallbacks[\"chart1\"](dt, simulator);\n      }\n      if (onSceneUpdateChartCallbacks[\"chart2\"]) {\n        onSceneUpdateChartCallbacks[\"chart2\"](dt, simulator);\n      }\n      if (onSceneUpdateChartCallbacks[\"chart3\"]) {\n        onSceneUpdateChartCallbacks[\"chart3\"](dt, simulator);\n      }\n    }\n  }\n\n  return (\n    <div>\n      <SideMenu />\n      <Container maxWidth='xl'>\n        <Grid container spacing={2} direction=\"row\" alignItems=\"center\">\n          <Grid item xs={12} md={10} lg={10} style={{padding: \"0px 0px 0px 60px\"}}>\n            <InputLabel htmlFor=\"scene-select\">SCENE</InputLabel>\n            <Select\n              onChange={(event: SelectChangeEvent) => {\n                setThreeObjs([]);\n                setSelectedScene(event.target.value);\n              }}\n              // displayEmpty\n              label=\"Scene\"\n              value={selectedScene}\n              variant=\"outlined\"\n            >\n              <MenuItem value=\"\">\n                <em>None</em>\n              </MenuItem>\n              <ListSubheader style={{color: '#0000FF'}}>--Frontend Calculated--</ListSubheader>\n              {scenes.map((scene) => (\n                <MenuItem value={scene}>\n                  {scene}\n                </MenuItem>\n              ))}\n              <ListSubheader style={{color: '#0000FF'}}>--Backend Calculated--</ListSubheader>\n            </Select>\n          </Grid>\n          <Grid item xs={12} md={2} lg={2} style={{padding: \"0px 60px 0px 0px\"}}>\n            <Button\n              variant=\"contained\"\n              onClick={(event) => {\n                if (simulator !== undefined) {\n                  console.log(\"run button\")\n                  if (simulator.isRunning()) {\n                    simulator.stop();\n                    setRunStopBtnText(\"RUN\");\n                  } else {\n                    simulator.start();\n                    setRunStopBtnText(\"STOP\");\n                  }\n                }\n              }}\n              style={{marginRight: \"10px\"}}\n            >\n              {runStopBtnText}\n            </Button>\n            <Button variant=\"contained\" onClick={(event) => {\n              if (simulator !== undefined) {\n                simulator.reset();\n                setRunStopBtnText(\"RUN\");\n              }\n            }}>\n              Reset\n            </Button>\n          </Grid>\n          <Grid item xs={12} md={8} lg={8}>\n            <Paper\n              style={{padding: \"10px 50px 30px\", margin: \"0px 0px 0px 40px\", height: 550}}\n            >\n              {`3DViewer / ${selectedScene}`}\n              <ThreeContext.Provider value={{\n                width: 0.55*window.innerWidth,\n                height: 0.6*window.innerHeight,\n                camera: camera,\n                setCamera: setCamera,\n                objects: threeObjs,\n                simulator: simulator,\n                setSimulator: setSimulator,\n                onUpdateChart: onSceneUpdate,\n              }}>\n                {\n                  (() => {\n                    if (selectedScene === \"CoordinateAxisScene\") {\n                      return <CoordinateAxisScene/>\n                    } else if (selectedScene === \"TestBoxPlaneScene\") {\n                      return <TestBoxPlaneScene/>\n                    } else if (selectedScene === \"BouncingBallScene\") {\n                      return <BouncingBallScene />\n                    }\n                  })()\n                }\n              </ThreeContext.Provider>\n            </Paper>\n          </Grid>\n          <Grid item xs={12} md={4} lg={4}>\n            <Paper style={{padding: \"5px 5px 5px\", margin: \"0px 40px 0px 0px\", height: 550}}>\n              <ParameterContext.Provider value={{\n                params: scene2Params(selectedScene),\n                onParameterChaneged: (params: Parameter[], autoApply: boolean) => {\n                  console.log(`param changed : ${autoApply}`)\n                  console.log(params)\n                  if (simulator !== undefined && autoApply) {\n                    console.log('Setting params')\n                    simulator.setSystemParams(params);\n                  }\n                }\n              }}>\n                <ParameterSettingsTab />\n              </ParameterContext.Provider>\n            </Paper>\n          </Grid>\n          {/* Chart */}\n          <ChartContext.Provider value={{\n            onSceneUpdateChartCallbacks: onSceneUpdateChartCallbacks,\n            setOnSceneUpdateChartCallbacks: setOnSceneUpdateChartCallbacks,\n            chartRefs: chartRefs,\n            setChartRefs: setChartRefs,\n          }}>\n            <Grid item xs={4}>\n              <Paper style={{padding: \"10px 10px 10px\", margin: \"0px 0px 0px 40px\", height: 300}}>\n                <ConfigurableChart\n                  data={(() => {\n                    if (simulator) {\n                      const data: any = simulator.historicalData();\n                      console.log(data)\n                      return data;\n                    } else {\n                      return {};\n                    }\n                  })()}\n                  variables={selectableVariables}\n                  tag=\"chart1\"\n                />\n              </Paper>\n            </Grid>\n            <Grid item xs={4}>\n              <Paper style={{padding: \"10px 50px 10px\", margin: \"0px 0px 0px 0px\", height: 300}}>\n              <ConfigurableChart\n                  data={(() => {\n                    if (simulator) {\n                      const data: any = simulator.historicalData();\n                      console.log(data)\n                      return data;\n                    } else {\n                      return {};\n                    }\n                  })()}\n                  variables={selectableVariables}\n                  tag=\"chart2\"\n                />\n              </Paper>\n            </Grid>\n            <Grid item xs={4}>\n              <Paper style={{padding: \"10px 10px 10px\", margin: \"0px 40px 0px 0px\", height: 300}}>\n              <ConfigurableChart\n                  data={(() => {\n                    if (simulator) {\n                      const data: any = simulator.historicalData();\n                      return data;\n                    } else {\n                      return {};\n                    }\n                  })()}\n                  variables={selectableVariables}\n                  tag=\"chart3\"\n                />\n              </Paper>\n            </Grid>\n          </ChartContext.Provider>\n        </Grid>\n      </Container>\n    </div>\n  )\n}\n\nexport default PhysicalSimulation;\n","import { MuiThemeProvider } from '@material-ui/core/styles';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport { darkTheme } from './theme/MaterialUI';\nimport PhysicalSimulation from './pages/PhysicalSimulation';\n\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <MuiThemeProvider theme={darkTheme}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <Switch>\n            <Route path=\"/\" component={PhysicalSimulation} exact />\n          </Switch>\n          <Switch>\n            <Route path=\"/physical_simulation\" component={PhysicalSimulation} exact />\n          </Switch>\n        </Router>\n      </MuiThemeProvider>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}